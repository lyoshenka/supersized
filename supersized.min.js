(function(d){d.supersized=function(g){return{options:{},slides:[],newSlides:[],currentSlide:0,inAnimation:!1,isPaused:!1,run:function(a){var b=this;d(document).ready(function(){b.initOptions(a);b.init();b.initFlickr()});return b},toggleHybridMode:function(){1==this.options.performance&&this.element.toggleClass("quality").toggleClass("speed")},nextSlideIndex:function(){return(this.currentSlide+1)%this.slides.length},prevSlideIndex:function(){return(this.currentSlide-1+this.slides.length)%this.slides.length},
updateCaption:function(){this.options.slide_captions&&d(this.options.slidecaption_selector).html(this.slides[this.currentSlide].title||"")},updateSlideCounter:function(){this.options.slide_counter&&(d(this.options.slidecounter_slidenumber_selector).html(this.currentSlide+1),d(this.options.slidecounter_totalslides_selector).html(this.slides.length))},updateThumbnails:function(){1==this.options.thumbnail_navigation&&(d(this.options.prevthumb_selector).html(d("<img/>").attr("src",this.slides[this.prevSlideIndex()].thumb)),
d(this.options.nextthumb_selector).html(d("<img/>").attr("src",this.slides[this.nextSlideIndex()].thumb)))},startAnimation:function(){this.slideshow_interval=setInterval(this.nextSlideBound,this.options.slide_interval);d(this.options.pauseplay_selector).attr("src")&&d(this.options.pauseplay_selector).attr("src",this.options.image_path+"pause_dull.png");this.isPaused=!1},pauseAnimation:function(){clearInterval(this.slideshow_interval);d(this.options.pauseplay_selector).attr("src")&&d(this.options.pauseplay_selector).attr("src",
this.options.image_path+"play_dull.png");this.isPaused=!0},onPrevClick:function(a){a.preventDefault();this.inAnimation||(clearInterval(this.slideshow_interval),this.prevSlide(),this.isPaused||(this.slideshow_interval=setInterval(this.nextSlideBound,this.options.slide_interval)))},onNextClick:function(a){a.preventDefault();this.inAnimation||(clearInterval(this.slideshow_interval),this.nextSlide(),this.isPaused||(this.slideshow_interval=setInterval(this.nextSlideBound,this.options.slide_interval)))},
init:function(){d("body").prepend('<div id="supersized-loader"></div>').prepend('<div id="supersized"></div>');this.element=d("#supersized");this.linkTarget=g.new_window?' target="_blank"':"";this.nextSlideBound=this.nextSlide.bind(this);this.prevSlideBound=this.prevSlide.bind(this);3==this.options.performance?this.element.addClass("speed"):(1==this.options.performance||2==this.options.performance)&&this.element.addClass("quality");this.element.hide();this.options.image_protect&&(this.element.on("contextmenu",
"img",function(){return!1}),this.element.on("mousedown","img",function(){return!1}));d(window).resize(this.resizeImages.bind(this))},initOptions:function(a){this.options=d.extend({controls_selector:"#controls",pauseplay_selector:"#pauseplay",prevthumb_selector:"#prevthumb",nextthumb_selector:"#nextthumb",prevslide_selector:"#prevslide",nextslide_selector:"#nextslide",slidecaption_selector:"#slidecaption",slidecounter_slidenumber_selector:"#slidecounter .slidenumber",slidecounter_totalslides_selector:"#slidecounter .totalslides",
slideshow:1,autoplay:0,start_slide:1,random:0,slide_interval:5E3,transition:1,transition_speed:750,new_window:1,pause_hover:0,keyboard_nav:1,performance:1,image_protect:1,image_path:"img/",min_width:0,min_height:0,vertical_center:1,horizontal_center:1,fit_always:0,fit_portrait:0,fit_landscape:0,navigation:0,thumbnail_navigation:0,slide_counter:1,slide_captions:1,source:2,set:"###",user:"###",group:"###",tags:"###,###",total_slides:100,image_size:"z",sort_by:1,sort_direction:0,api_key:"#############"},
a||{})},initFlickr:function(){var a=this,b="",c="";switch(a.options.sort_by){case 2:b="date-taken";break;case 3:b="interestingness";break;default:b="date-posted"}b+=1==a.options.sort_direction?"-asc":"-desc";switch(a.options.source){case 1:c="http://api.flickr.com/services/rest/?&method=flickr.photosets.getPhotos&api_key="+a.options.api_key+"&photoset_id="+a.options.set+"&per_page="+a.options.total_slides+"&sort="+b+"&format=json&jsoncallback=?";break;case 2:c="http://api.flickr.com/services/rest/?format=json&method=flickr.photos.search&api_key="+
a.options.api_key+"&user_id="+a.options.user+"&per_page="+a.options.total_slides+"&sort="+b+"&jsoncallback=?";break;case 3:c="http://api.flickr.com/services/rest/?format=json&method=flickr.photos.search&api_key="+a.options.api_key+"&group_id="+a.options.group+"&per_page="+a.options.total_slides+"&sort="+b+"&jsoncallback=?";break;case 4:c="http://api.flickr.com/services/rest/?format=json&method=flickr.photos.search&api_key="+a.options.api_key+"&tags="+a.options.tags+"&per_page="+a.options.total_slides+
"&sort="+b+"&jsoncallback=?"}d.ajax({type:"GET",url:c,dataType:"json",async:!0,success:function(b){a.newSlides=1==a.options.source?b.photoset.photo:b.photos.photo;a.newSlides.length?a.loadSlides():alert("no pictures loaded from flickr")}})},loadSlides:function(){var a=this,b=[],c="";d.each(a.newSlides,function(c,d){b.push({image:"http://farm"+d.farm+".static.flickr.com/"+d.server+"/"+d.id+"_"+d.secret+"_"+a.options.image_size+".jpg",thumb:"http://farm"+d.farm+".static.flickr.com/"+d.server+"/"+d.id+
"_"+d.secret+"_t.jpg",title:d.title,url:"http://www.flickr.com/photos/"+d.owner+"/"+d.id+"/"})});a.slides=b;if(a.options.random)for(var e,f,c=b.length;c;e=parseInt(Math.random()*c),f=b[--c],b[c]=b[e],b[e]=f);else a.options.start_slide&&(a.currentSlide=Math.max(a.options.start_slide,b.length)-1);1<b.length&&(e=a.prevSlideIndex(),c=b[e].url?"href='"+b[e].url+"'":"",d("<img/>").attr("src",b[e].image).appendTo(a.element).wrap("<a "+c+a.linkTarget+"></a>"));c=b[a.currentSlide].url?"href='"+b[a.currentSlide].url+
"'":"";d("<img/>").attr("src",b[a.currentSlide].image).appendTo(a.element).wrap('<a class="activeslide" '+c+a.linkTarget+"></a>");d(".activeslide img").on("load",a.resizeImages.bind(a));1<b.length&&(e=a.nextSlideIndex(),c=b[e].url?"href='"+b[e].url+"'":"",d("<img/>").attr("src",b[e].image).appendTo(a.element).wrap("<a "+c+a.linkTarget+"></a>"));a.start()},start:function(){this.resizeImages();d("#supersized-loader").remove();this.element.fadeIn("fast");this.updateSlideCounter();this.updateCaption();
this.updateThumbnails();this.options.slideshow&&(this.options.autoplay&&this.startAnimation(),this.initNavigation())},initNavigation:function(){var a=this;if(a.options.navigation){d(a.options.controls_selector).show();d(a.options.pauseplay_selector).click(function(b){b.preventDefault();a.inAnimation||(a.isPaused?a.startAnimation():a.pauseAnimation())});d(a.options.prevslide_selector).click(a.onPrevClick.bind(a));d(a.options.nextslide_selector).click(a.onNextClick.bind(a));a.options.thumbnail_navigation&&
(d(a.options.prevthumb_selector).show().click(a.onPrevClick.bind(a)),d(a.options.nextthumb_selector).show().click(a.onNextClick.bind(a)));if(d(a.options.nextslide_selector).attr("src"))d(a.options.nextslide_selector).on("mousedown",function(){d(this).attr("src",a.options.image_path+"forward.png")}).on("mouseup mouseout",function(){d(this).attr("src",a.options.image_path+"forward_dull.png")});if(d(a.options.prevslide_selector).attr("src"))d(a.options.prevslide_selector).on("mouseup",function(){d(this).attr("src",
a.options.image_path+"back.png")}).on("mouseup mouseout",function(){d(this).attr("src",a.options.image_path+"back_dull.png")})}},resizeImages:function(){var a=this;return a.element.find("img").each(function(){var b=d(this),c=(b.height()/b.width()).toFixed(2),e=d(window).width(),f=d(window).height();a.options.fit_always?f/e>c?a.resizeWidth(b):a.resizeHeight(b):f<=a.options.min_height&&e<=a.options.min_width?f/e>c?a.options.fit_landscape&&1>=c?a.resizeWidth(b,!0):a.resizeHeight(b,!0):a.options.fit_portrait&&
1<c?a.resizeHeight(b,!0):a.resizeWidth(b,!0):e<=a.options.min_width?f/e>c?a.options.fit_landscape&&1>=c?resizeWidth(b,!0):resizeHeight(b):a.options.fit_portrait&&1<c?resizeHeight(b):resizeWidth(b,!0):f<=a.options.min_height?f/e>c?a.options.fit_landscape&&1>=c?resizeWidth(b):resizeHeight(b,!0):a.options.fit_portrait&&1<c?resizeHeight(b,!0):resizeWidth(b):f/e>c?a.options.fit_landscape&&1>=c?resizeWidth(b):resizeHeight(b):a.options.fit_portrait&&1<c?resizeHeight(b):resizeWidth(b);a.options.horizontal_center&&
d(this).css("left",(e-b.width())/2);a.options.vertical_center&&d(this).css("top",(f-b.height())/2)})},resizeWidth:function(a,b){var c=(a.height()/a.width()).toFixed(2),e=d(window).width(),f=d(window).height();if(b){if(a.width()<e||a.width()<this.options.min_width)a.width()*c>=this.options.min_height?(a.width(this.options.min_width),a.height(a.width()*c)):this.resizeHeight(a)}else this.options.min_height>=f&&!this.options.fit_landscape?e*c>=this.options.min_height||e*c>=this.options.min_height&&1>=
c?(a.width(e),a.height(e*c)):1<c?(a.height(this.options.min_height),a.width(a.height()/c)):a.width()<e&&(a.width(e),a.height(a.width()*c)):(a.width(e),a.height(e*c))},resizeHeight:function(a,b){var c=(a.height()/a.width()).toFixed(2),e=d(window).width(),f=d(window).height();b?a.height()<f&&(a.height()/c>=this.options.min_width?(a.height(this.options.min_height),a.width(a.height()/c)):this.resizeWidth(a,!0)):this.options.min_width>=e?f/c>=this.options.min_width||1<c?(a.height(f),a.width(f/c)):1>=c&&
(a.width(this.options.min_width),a.height(a.width()*c)):(a.height(f),a.width(f/c))},nextSlide:function(a){if(this.inAnimation)return!1;this.inAnimation=!0;var b=this.element.find(".activeslide"),c=b.next().length?b.next():this.element.find("a:first"),e=b.prev().length?b.prev():this.element.find("a:last");if(a)var f=c,c=e,e=f;this.element.find(".prevslide").removeClass("prevslide");b.removeClass("activeslide").addClass("prevslide");this.toggleHybridMode();c.hide().addClass("activeslide");this.doTransition(b,
c,a);this.currentSlide=(this.currentSlide+(a?this.slides.length-1:1))%this.slides.length;this.updateSlideCounter();this.updateCaption();this.updateThumbnails();e.remove();b=a?this.prevSlideIndex():this.nextSlideIndex();c=this.slides[b].url?"href='"+this.slides[b].url+"'":"";d("<img/>").attr("src",this.slides[b].image)[a?"prependTo":"appendTo"](this.element).wrap("<a "+c+this.linkTarget+"></a>")},prevSlide:function(){this.nextSlide(!0)},doTransition:function(a,b,c){var e=c?-1:1,c=d(window).width()*
e,e=d(window).height()*e;switch(this.options.transition){case 0:b.show();this.inAnimation=!1;break;case 1:b.fadeTo(this.options.transition_speed,1,this.afterAnimation.bind(this));break;case 2:b.animate({top:-e},0).show().animate({top:0},this.options.transition_speed,this.afterAnimation.bind(this));break;case 3:b.animate({left:c},0).show().animate({left:0},this.options.transition_speed,this.afterAnimation.bind(this));break;case 4:b.animate({top:e},0).show().animate({top:0},this.options.transition_speed,
this.afterAnimation.bind(this));break;case 5:b.animate({left:-c},0).show().animate({left:0},this.options.transition_speed,this.afterAnimation.bind(this));break;case 6:b.animate({left:c},0).show().animate({left:0},this.options.transition_speed,this.afterAnimation.bind(this));a.animate({left:-c},this.options.transition_speed);break;case 7:b.animate({left:-c},0).show().animate({left:0},this.options.transition_speed,this.afterAnimation.bind(this)),a.animate({left:c},this.options.transition_speed)}},afterAnimation:function(){this.inAnimation=
!1;this.toggleHybridMode();this.resizeImages()}}.run(g)}})(jQuery);